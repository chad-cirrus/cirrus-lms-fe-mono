<div class="main-container">
  <div class="header-container">
    <cirrus-global-header
      [cirrusUser]="(cirrusUser$ | async)!"
      [cirrusImpersonationReturnUser]="(cirrusImpersonateReturnUser$ | async)!"
      (hamburgerMenu)="openHamburgerMenu()"
      [notificationCount]="(notifications$ | async)?.length!"
      (logout)="logout()"
      (impersonationLogout)="impersonationLogout()"
      [isScreenSmall]="(isScreenSmall$ | async)!"
      [deployUrl]="'courses'"
    ></cirrus-global-header>
  </div>
  <main fxLayout="row">
    <div
      [fxFlex]="collapse ? '0 0 100px' : '0 0 200px'"
      class="sidenav"
      *ngIf="(isScreenSmall$ | async) === false"
    >
      <cirrus-global-side-nav
        [cirrusUser]="(cirrusUser$ | async)!"
        (emitCollapse)="toggleCollapse($event)"
        [notificationCount]="(notifications$ | async)?.length!"
        (toggleNotificationsMenu)="toggleNotificationsMenu()"
        [deployUrl]="'courses'"
      ></cirrus-global-side-nav>
    </div>
    <div class="content-container" [fxFlex]="100">
      <div
        class="outlet-container"
        [ngClass]="{ 'stop-scrolling': sideNavOpen$ | async }"
        #outletContainer
      >
        <div *ngIf="loadingIndicator$ | async" class="spinner-container">
          <mat-spinner color="accent"></mat-spinner>
        </div>
        <div *ngIf="error$ | async" class="error-container">
          <cirrus-error-notification
            [calledFromWhatMfe]="project"
            (emitClose)="dismissErrorMessage()"
          ></cirrus-error-notification>
        </div>

        <router-outlet></router-outlet>
      </div>
    </div>
  </main>
</div>

<mat-sidenav-container class="sidenav-container">
  <mat-sidenav
    #drawer
    class="sidenav"
    fixedInViewport="true"
    mode="push"
    (closedStart)="drawerClosed()"
    (openedStart)="drawerOpened()"
  >
    <cirrus-notifications-menu
      (acceptInvitationEmit)="acceptInvite($event)"
      (declineInvitationEmit)="declineInvite($event)"
      (clearNotficationsEmit)="clearNotifications($event)"
      (deleteNotificationEmit)="deleteNotification($event)"
      (dismissMenu)="dismissNotificationsMenu()"
      [notifications]="(notifications$ | async)!"
      [projectName]="project"
    ></cirrus-notifications-menu>
  </mat-sidenav>
</mat-sidenav-container>
